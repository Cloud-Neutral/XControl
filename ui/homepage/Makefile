# Makefile for src/homepage (Next.js static site)

SHELL := /bin/bash
NODE_VERSION := $(shell node -v 2>/dev/null)
YARN := $(shell command -v yarn 2>/dev/null)

.PHONY: init dev build export clean info

icon:
	@echo "ğŸ¨ Generating favicon and icon images..."
	@if ! command -v magick &> /dev/null; then \
		echo "âŒ ImageMagick (magick) not found. Please install it (e.g. brew install imagemagick)."; \
		exit 1; \
	fi
	@mkdir -p public/icons
	@magick ../logo.png -resize 32x32 public/icons/cloudnative_32.png
	@magick ../logo.png -resize 64x64 -background none -define icon:auto-resize=64,48,32,16 public/favicon.ico
	@echo "âœ… Icons generated successfully."

init:
	@echo "ğŸ”§ Installing dependencies for homepage..."
	@if [ -z "$(YARN)" ]; then \
		echo "âš ï¸  Yarn not found. Installing via Homebrew..."; \
		brew install yarn; \
	fi
	yarn install

dev:
	@echo "ğŸš€ Starting Next.js dev server (homepage)..."
	yarn next dev -p 3001

build:
	@echo "ğŸ”¨ Building homepage..."
	yarn next build

export:
	@echo "ğŸ“¦ Exporting homepage static site to ./out ..."
	yarn next build

clean:
	@echo "ğŸ§¹ Cleaning .next and out directories..."
	rm -rf .next out

info:
	@echo "ğŸ§¾ Node.js version: $(NODE_VERSION)"

